y[i] = runif(1,1,2)
} else if (zones[i] == 7) {
x[i] = runif(1,0,1)
y[i] = runif(1,0,1)
} else if (zones[i] == 8) {
x[i] = runif(1,1,2)
y[i] = runif(1,0,1)
} else if (zones[i] == 9) {
x[i] = runif(1,2,3)
y[i] = runif(1,0,1)
}
}
test$xpos = x
test$ypos = y
View(test)
install.packages('patchwork')
strsplit('France vs. Germany', ' ')[[1]][3]
strsplit('France vs. Germany', ' ')[[1]][1]
test$Country
unique(test$Country)
unique(test$Country)[1]
library('patchwork')
library(patchwork)
runApp()
runApp()
runApp()
runApp()
runApp()
View(test)
shotzone(test)
shotzone = function(data) {
zones = data$Zone
x = c()
y = c()
for (i in seq_along(zones)) {
if (zones[i] == 1) {
x[i] = runif(1,0,1)
y[i] = runif(1,2,3)
} else if (zones[i] == 2) {
x[i] = runif(1,1,2)
y[i] = runif(1,2,3)
} else if (zones[i] == 3) {
x[i] = runif(1,2,3)
y[i] = runif(1,2,3)
} else if (zones[i] == 4) {
x[i] = runif(1,0,1)
y[i] = runif(1,1,2)
} else if (zones[i] == 5) {
x[i] = runif(1,1,2)
y[i] = runif(1,1,2)
} else if (zones[i] == 6) {
x[i] = runif(1,2,3)
y[i] = runif(1,1,2)
} else if (zones[i] == 7) {
x[i] = runif(1,0,1)
y[i] = runif(1,0,1)
} else if (zones[i] == 8) {
x[i] = runif(1,1,2)
y[i] = runif(1,0,1)
} else if (zones[i] == 9) {
x[i] = runif(1,2,3)
y[i] = runif(1,0,1)
}
}
data$xpos = x
data$ypos = y
}
test
shotzone(test)
shotzone(test) |>
View()
shotzone = function(data) {
zones = data$Zone
x = c()
y = c()
for (i in seq_along(zones)) {
if (zones[i] == 1) {
x[i] = runif(1,0,1)
y[i] = runif(1,2,3)
} else if (zones[i] == 2) {
x[i] = runif(1,1,2)
y[i] = runif(1,2,3)
} else if (zones[i] == 3) {
x[i] = runif(1,2,3)
y[i] = runif(1,2,3)
} else if (zones[i] == 4) {
x[i] = runif(1,0,1)
y[i] = runif(1,1,2)
} else if (zones[i] == 5) {
x[i] = runif(1,1,2)
y[i] = runif(1,1,2)
} else if (zones[i] == 6) {
x[i] = runif(1,2,3)
y[i] = runif(1,1,2)
} else if (zones[i] == 7) {
x[i] = runif(1,0,1)
y[i] = runif(1,0,1)
} else if (zones[i] == 8) {
x[i] = runif(1,1,2)
y[i] = runif(1,0,1)
} else if (zones[i] == 9) {
x[i] = runif(1,2,3)
y[i] = runif(1,0,1)
}
}
data |>
mutate(
xpos = x
)|>
mutate(
ypos = y
)
}
shotzone(test) |>
View()
data |>
mutate(
xpos = x,
ypos = y
)
shotzone = function(data) {
zones = data$Zone
x = c()
y = c()
for (i in seq_along(zones)) {
if (zones[i] == 1) {
x[i] = runif(1,0,1)
y[i] = runif(1,2,3)
} else if (zones[i] == 2) {
x[i] = runif(1,1,2)
y[i] = runif(1,2,3)
} else if (zones[i] == 3) {
x[i] = runif(1,2,3)
y[i] = runif(1,2,3)
} else if (zones[i] == 4) {
x[i] = runif(1,0,1)
y[i] = runif(1,1,2)
} else if (zones[i] == 5) {
x[i] = runif(1,1,2)
y[i] = runif(1,1,2)
} else if (zones[i] == 6) {
x[i] = runif(1,2,3)
y[i] = runif(1,1,2)
} else if (zones[i] == 7) {
x[i] = runif(1,0,1)
y[i] = runif(1,0,1)
} else if (zones[i] == 8) {
x[i] = runif(1,1,2)
y[i] = runif(1,0,1)
} else if (zones[i] == 9) {
x[i] = runif(1,2,3)
y[i] = runif(1,0,1)
}
}
data |>
mutate(
xpos = x,
ypos = y
)
}
shotzone(test) |>
View()
shotzone = function(data) {
zones = data$Zone
x = c()
y = c()
for (i in seq_along(zones)) {
if (zones[i] == 1) {
x[i] = runif(1,0,1)
y[i] = runif(1,2,3)
} else if (zones[i] == 2) {
x[i] = runif(1,1,2)
y[i] = runif(1,2,3)
} else if (zones[i] == 3) {
x[i] = runif(1,2,3)
y[i] = runif(1,2,3)
} else if (zones[i] == 4) {
x[i] = runif(1,0,1)
y[i] = runif(1,1,2)
} else if (zones[i] == 5) {
x[i] = runif(1,1,2)
y[i] = runif(1,1,2)
} else if (zones[i] == 6) {
x[i] = runif(1,2,3)
y[i] = runif(1,1,2)
} else if (zones[i] == 7) {
x[i] = runif(1,0,1)
y[i] = runif(1,0,1)
} else if (zones[i] == 8) {
x[i] = runif(1,1,2)
y[i] = runif(1,0,1)
} else if (zones[i] == 9) {
x[i] = runif(1,2,3)
y[i] = runif(1,0,1)
}
}
data |>
mutate(
xpos = x,
ypos = y
)
}
runApp()
runApp()
shotzone = function(data) {
zones = data$Zone
x = c()
y = c()
for (i in seq_along(zones)) {
if (zones[i] == 1) {
x[i] = runif(1,0,1)
y[i] = runif(1,2,3)
} else if (zones[i] == 2) {
x[i] = runif(1,1,2)
y[i] = runif(1,2,3)
} else if (zones[i] == 3) {
x[i] = runif(1,2,3)
y[i] = runif(1,2,3)
} else if (zones[i] == 4) {
x[i] = runif(1,0,1)
y[i] = runif(1,1,2)
} else if (zones[i] == 5) {
x[i] = runif(1,1,2)
y[i] = runif(1,1,2)
} else if (zones[i] == 6) {
x[i] = runif(1,2,3)
y[i] = runif(1,1,2)
} else if (zones[i] == 7) {
x[i] = runif(1,0,1)
y[i] = runif(1,0,1)
} else if (zones[i] == 8) {
x[i] = runif(1,1,2)
y[i] = runif(1,0,1)
} else if (zones[i] == 9) {
x[i] = runif(1,2,3)
y[i] = runif(1,0,1)
}
}
data |>
mutate(
xpos = x,
ypos = y
)
}
shotzone(test) |>
View()
shotzone(test) |>
|>
shotzone(test) |>
ggplot() +
aes(x = xpos, y = ypos) +
geom_point() +
#geom_image(aes(image = ball), size = 0.1) +
ylim(-1, 4) +
xlim(-0.3, 3.2)+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.title.y=element_blank())
runApp()
library(shiny)
library(tidyverse)
library(png)
library(ggimage)
library(grid)
library(patchwork)
pen_data = read_csv('data/penalty.csv')
img = readPNG('data/goalpost.png')
ui = navbarPage(
title = 'Penalty',
tabPanel(
title = 'World Cup Penalty Visualization',
titlePanel(title = 'Penalty World Cup Data: 1982 - 2022'),
sidebarLayout(
sidebarPanel(
selectInput(
inputId = 'yr',
label = 'Year',
choices = sort(unique(pen_data$Year)),
selected = 2018),
selectInput(
inputId = 'match',
label = 'Match',
choices = sort(unique(pen_data$Match)),
selected = 'Columbia vs. England')
),
mainPanel(plotOutput("goalmap"))
)
),
tabPanel(title = 'Penalty Summary Table'),
tabPanel(title = 'About')
)
server = function(input, output) {
match_by_year = reactive({
pen_data |>
filter(Year == input$yr)
})
observeEvent(
eventExpr = input$yr,
handlerExpr = {
updateSelectInput(inputId = 'match', choices = sort(match_by_year()$Match))
}
)
output$goalmap = renderPlot({
pen_new = pen_data |>
filter(Year == input$yr) |>
filter(Match == input$match) |>
shotzone() |>
ggplot() +
aes(x = xpos, y = ypos) +
geom_point() +
#geom_image(aes(image = ball), size = 0.1) +
ylim(-1, 4) +
xlim(-0.3, 3.2)+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.title.y=element_blank())
})
}
shinyApp(ui = ui, server = server)
runApp()
runApp()
runApp()
runApp()
runApp()
shotzone(test) |>
filter(Country == test$Country[1]) |>
ggplot() +
aes(x = xpos, y = ypos) +
geom_point() +
#geom_image(aes(image = ball), size = 0.1) +
ylim(-1, 4) +
xlim(-0.3, 3.2)+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.title.y=element_blank())
pa = shotzone(test) |>
filter(Country == test$Country[1]) |>
ggplot() +
aes(x = xpos, y = ypos) +
geom_point() +
#geom_image(aes(image = ball), size = 0.1) +
ylim(-1, 4) +
xlim(-0.3, 3.2)+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.title.y=element_blank())
pb = shotzone(test) |>
filter(Country == test$Country[2]) |>
ggplot() +
aes(x = xpos, y = ypos) +
geom_point() +
#geom_image(aes(image = ball), size = 0.1) +
ylim(-1, 4) +
xlim(-0.3, 3.2)+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.title.y=element_blank())
pb/pa
runApp()
't'+'q'
test = penalty_new |>
filter(Year == 1982) |>
filter(Match == 'France vs. West Germany')
shotzone = function(data) {
zones = data$Zone
x = c()
y = c()
for (i in seq_along(zones)) {
if (zones[i] == 1) {
x[i] = runif(1,0,1)
y[i] = runif(1,2,3)
} else if (zones[i] == 2) {
x[i] = runif(1,1,2)
y[i] = runif(1,2,3)
} else if (zones[i] == 3) {
x[i] = runif(1,2,3)
y[i] = runif(1,2,3)
} else if (zones[i] == 4) {
x[i] = runif(1,0,1)
y[i] = runif(1,1,2)
} else if (zones[i] == 5) {
x[i] = runif(1,1,2)
y[i] = runif(1,1,2)
} else if (zones[i] == 6) {
x[i] = runif(1,2,3)
y[i] = runif(1,1,2)
} else if (zones[i] == 7) {
x[i] = runif(1,0,1)
y[i] = runif(1,0,1)
} else if (zones[i] == 8) {
x[i] = runif(1,1,2)
y[i] = runif(1,0,1)
} else if (zones[i] == 9) {
x[i] = runif(1,2,3)
y[i] = runif(1,0,1)
}
}
data |>
mutate(
xpos = x,
ypos = y
)
}
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
goals = test$Goal
pen_num = test$Penalty_Number
scored = c()
for (i in seq_along(goals)) {
if (i == length(pen_num)) {
scored[i] = 'Winning Goal'
} else if (goals[i] == 1) {
scored[i] = 'Goal'
} else if (goals[i] == 0) {
scored[i] = 'Saved/Missed'
}
}
test |>
mutate(
outcome = scored
)
runApp()
runApp()
test = penalty_new |>
filter(Year == 2018) |>
filter(Match == 'Spain vs. Russia')
shotzone = function(data) {
zones = data$Zone
x = c()
y = c()
for (i in seq_along(zones)) {
if (zones[i] == 1) {
x[i] = runif(1,0,1)
y[i] = runif(1,2,3)
} else if (zones[i] == 2) {
x[i] = runif(1,1,2)
y[i] = runif(1,2,3)
} else if (zones[i] == 3) {
x[i] = runif(1,2,3)
y[i] = runif(1,2,3)
} else if (zones[i] == 4) {
x[i] = runif(1,0,1)
y[i] = runif(1,1,2)
} else if (zones[i] == 5) {
x[i] = runif(1,1,2)
y[i] = runif(1,1,2)
} else if (zones[i] == 6) {
x[i] = runif(1,2,3)
y[i] = runif(1,1,2)
} else if (zones[i] == 7) {
x[i] = runif(1,0,1)
y[i] = runif(1,0,1)
} else if (zones[i] == 8) {
x[i] = runif(1,1,2)
y[i] = runif(1,0,1)
} else if (zones[i] == 9) {
x[i] = runif(1,2,3)
y[i] = runif(1,0,1)
}
}
data |>
mutate(
xpos = x,
ypos = y
)
}
View(test)
runApp()
shiny::runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
knitr::opts_chunk$set(echo = TRUE)
plot(pressure)
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
runApp()
runApp()
runApp()
runApp()
library(tidyverse)
penalty = read_csv(file = 'data/WorldCupShootouts.csv')
penalty_new = penalty |>
select(Year, Match, Team, Country, everything()) |>
select(-Game_id, -Team) |>
drop_na()
write_csv(x = penalty_new, file = 'data/penalty.csv')
shiny::runApp()
